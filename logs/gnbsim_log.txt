root@291607c97b66:/example# ip tuntap del mode tun gtp-gnb
root@291607c97b66:/example# ./example 
[gnbsim]2021/03/07 10:48:43.172324 example.go:46: Dail LocalAddr: 127.0.0.1/192.168.62.198/192.168.61.198/12.1.1.2:56654; RemoteAddr: 192.168.61.195:38412
[gnbsim]2021/03/07 10:48:43.172448 example.go:66: write: len 44, info: &{Stream:0 SSN:0 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:0 CumTSN:0 AssocID:0}
[gnbsim]2021/03/07 10:48:43.173564 example.go:87: read: len 512, info: &{Stream:0 SSN:0 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954155 CumTSN:0 AssocID:88}
dump: 2015003c0000040001000903004f41492d414d46005640011e0060000f010002f8595f00400064f0110b0041005000100002f859000116f000007b100800000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
Procedure Code: id-NGSetup (21)
PDU Length: 60
Protocol IEs: 4 items
  Item 0
    Protocol IE: id-AMFName (1)
      IE length: 9
        decoding id(1) not supported yet.
        dump: 03004f41492d414d46
  Item 1
    Protocol IE: id-RelativeAMFCapacity (86)
      IE length: 1
        decoding id(86) not supported yet.
        dump: 1e
  Item 2
    Protocol IE: id-ServedGUAMIList (96)
      IE length: 15
        decoding id(96) not supported yet.
        dump: 010002f8595f00400064f0110b0041
  Item 3
    Protocol IE: id-PLMNSupportList (80)
      IE length: 16
        decoding id(80) not supported yet.
        dump: 0002f859000116f000007b100800000c
[gnbsim]2021/03/07 10:48:43.173826 example.go:66: write: len 72, info: &{Stream:0 SSN:0 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954155 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:43.190232 example.go:87: read: len 528, info: &{Stream:0 SSN:1 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954156 CumTSN:0 AssocID:88}
dump: 0004403e000003000a000200010055000200000026002b2a7e0056020200002192fa872a17fe4b66c98e6e3d26d1740a2010485be0d0dc5c90018feb563045370e855fb1677f00000000000000000000407e5fb1677f0000707c5fb1677f0000ffffffffffffffff0000000000000000407e5fb1677f0000ed48ac7f29560000ffffffff00000000900f0094677f0000707b5fb1677f0000a01fc8b8677f00000000000000000000907b5fb1677f0000307b5fb1677f0000507d5fb1677f0000507c5fb1677f0000307c5fb1677f0000107c5fb1677f0000901b00a0677f0000001c00a0677f000076a7a87f295600000200000000000000009e752afc2ec508307b5fb1677f0000307b5fb1677f0000407c5fb1677f0000707d5fb1677f0000307c5fb1677f00002906a97f2956000039350000677f0000400c0094677f0000400c0094677f000000000000000000002800000030000000407c5fb1677f0000707b5fb1677f0000009e752afc2ec508f0160094677f000070180094677f000070180094677f000000000000000000005f000000000000000000000000000000180e0094677f00000000000000000000000000000000000038210094677f000038210094677f00000000000000000000d0acf87f2956000080130094677f0000c8130094677f00001000000000000000101a009402000000070000000000000020000000000000001800000000000000
Procedure Code: id-DownlinkNASTransport (4)
PDU Length: 62
Protocol IEs: 3 items
  Item 0
    Protocol IE: id-AMF-UE-NGAP-ID (10)
      IE length: 2
  Item 1
    Protocol IE: id-RAN-UE-NGAP-ID (85)
      IE length: 2
  Item 2
    Protocol IE: id-NAS-PDU (38)
      IE length: 43
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x0
        Message Type: Authentication Request (0x56)
          Authentication Request
            ngKSI IE
              NAS key set identifier: 0x2
            ABBA IE
              ABBA
                Length: 2
                Value: 0x0000
            Authentication Parameter RAND IE: 0x21
              RAND: 0x92fa872a17fe4b66c98e6e3d26d1740a
            Authentication Parameter AUTN IE: 0x20
              AUTN: 485be0d0dc5c90018feb563045370e85
              SEQ xor AK: 485be0d0dc5c
              AMF       : 9001
              MAC       : 8feb563045370e85
            received and calculated MAC values match.
[gnbsim]2021/03/07 10:48:43.190623 example.go:66: write: len 64, info: &{Stream:0 SSN:1 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954156 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:43.191524 example.go:87: read: len 344, info: &{Stream:0 SSN:2 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954157 CumTSN:0 AssocID:88}
dump: 00044027000003000a0002000100550002000000260014137e03cca1b176007e005d0202028020e1360102b1677f00006f7b5fb1677f000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff80000000000000000000000000005fb1677f00000000000000000000ffffffff00000000900f0094677f0000ffffffffffffffff00000000000000000000000000000000907b5fb1677f0000ffffffff677f0000507d5fb1677f0000507c5fb1677f0000a01fc8b8677f00000000000000000000901b00a0677f0000001c00a0677f000076a7a87f295600000200000000000000009e752afc2ec508307b5fb1677f0000307b5fb1677f0000407c5fb1677f000076a7a87f295600000200000000000000009e752afc2ec508607b5fb1677f0000607b5fb1677f0000707c5fb1677f0000707d5fb1677f0000607c5fb1677f0000
Procedure Code: id-DownlinkNASTransport (4)
PDU Length: 39
Protocol IEs: 3 items
  Item 0
    Protocol IE: id-AMF-UE-NGAP-ID (10)
      IE length: 2
  Item 1
    Protocol IE: id-RAN-UE-NGAP-ID (85)
      IE length: 2
  Item 2
    Protocol IE: id-NAS-PDU (38)
      IE length: 20
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x3
          mac: cca1b176
          seq: 0
        ***** Integrity check passed
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x0
        Message Type: Security Mode Command (0x5d)
          Security Mode Command
            Selected NAS security algorithms IE
              NAS Security Algorithms: 0x02
            ngKSI IE
              NAS key set identifier: 0x2
            Replayed UE security capabilities IE
              Capability: 0x8020
            IMEISV Request: 0xe
              value: 0x1
            Additional 5G Security Information: 0x36
              value: 0x2
                KAMF derivation is not required
                Retransmission of the initial NAS message requested
[gnbsim]2021/03/07 10:48:43.191843 example.go:66: write: len 93, info: &{Stream:0 SSN:2 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954157 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:43.193017 example.go:87: read: len 1120, info: &{Stream:0 SSN:3 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954158 CumTSN:0 AssocID:88}
dump: 000e008087000007000a00020001005500020000001c00070002f859800041007700091c000e000700038000005e00208df69f5043390c5891597a6274afcf630d9724fb55c58e8d754934dfd317cc9b0026002f2e7e02e879a703017e0042010177000bf202f8598000410000000154070002f85900a00015020101210200005e01be0000000502010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
Procedure Code: id-InitialContextSetup (14)
PDU Length: 135
Protocol IEs: 7 items
  Item 0
    Protocol IE: id-AMF-UE-NGAP-ID (10)
      IE length: 2
  Item 1
    Protocol IE: id-RAN-UE-NGAP-ID (85)
      IE length: 2
  Item 2
    Protocol IE: id-GUAMI (28)
      IE length: 7
        decoding id(28) not supported yet.
        dump: 0002f859800041
  Item 3
    Protocol IE: id-UESecurityCapabilities (119)
      IE length: 9
        decoding id(119) not supported yet.
        dump: 1c000e000700038000
  Item 4
    Protocol IE: id-SecurityKey (94)
      IE length: 32
        decoding id(94) not supported yet.
        dump: 8df69f5043390c5891597a6274afcf630d9724fb55c58e8d754934dfd317cc9b
  Item 5
    Protocol IE: id-NAS-PDU (38)
      IE length: 47
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x2
          mac: e879a703
          seq: 1
        ***** Integrity check passed
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x0
        Message Type: Registration Accept (0x42)
          Registration Accept
            5GS registration result IE
              5G Registration Result: 01
                Not registered for emergency services
                Network slice-specific authentication and authorization is not to be performed
                SMS over NAS not allowed
                3GPP access
            5G-GUTI: 0x77
              5GS mobile identity
                5G-GUTI: 02f85980004100000001
            TAI list: 0x54
              5GS tracking area identity list
                number of element: 1
                type of list: 0x0
                MCC: 208
                MNC: 95
                tac: 0x00a000
            Allowed NSSAI: 0x15
              S-NSSAI
                SST: 1
  Item 6
    Protocol IE: id-AllowedNSSAI (0)
      IE length: 5
        decoding id(0) not supported yet.
        dump: 0201000000
[gnbsim]2021/03/07 10:48:43.193587 example.go:66: write: len 19, info: &{Stream:0 SSN:3 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954158 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:43.193738 example.go:66: write: len 53, info: &{Stream:0 SSN:3 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954158 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:46.193959 example.go:98: read: timeout
[gnbsim]2021/03/07 10:48:47.194252 example.go:66: write: len 82, info: &{Stream:0 SSN:3 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954158 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:47.199721 example.go:87: read: len 160, info: &{Stream:0 SSN:4 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954159 CumTSN:0 AssocID:88}
dump: 001d00809b000003000a00020001005500020000004a008087004001517e02bf995320027e00680100422e0101c201000901000631310101ff060606001606001459002905010c01010256002204de230100807800007900060620410101067b000180250764656661756c74120100202f0000040082000a0c014fb1803001312d00008b000a01f0c0a83ec93248c53500860001000088000700060000060000
Procedure Code: id-PDUSessionResourceSetup (29)
PDU Length: 155
Protocol IEs: 3 items
  Item 0
    Protocol IE: id-AMF-UE-NGAP-ID (10)
      IE length: 2
  Item 1
    Protocol IE: id-RAN-UE-NGAP-ID (85)
      IE length: 2
  Item 2
    Protocol IE: id-PDUSessionResourceSetupListSUReq (74)
      IE length: 135
        number of sequence: 1
          PDU Session ID: 1
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x2
          mac: bf995320
          seq: 2
        ***** Integrity check passed
        EPD: 5G Mobility Management (0x7e)
        Security Header: 0x0
        Message Type: DL NAS Transport (0x68)
          DL NAS Transport
            Payload container type
              Type: N1 SM Information(0x1)
            Payload container
              Length: 66
              EPD: 5G Session Management (0x2e)
              PDU Session Identity: 0x1
              Procedure Transaction Identity: 0x1
              Message Type: PDU Session Establishment Accept (0xc2)
                PDU Session Establishment Accept
                  Selected PDU session type
                    PDU Session Type: IPv4(1)
                  Selected SSC mode
                    SSC Mode: SSC mode 0(0)
                  Authorized QoS rules
                    QoS rules
                      Length: 9
                      Qos rule 0
                        QoS rule identifier: 1
                        Length: 6
                        Rule operation code: Create new QoS rule(1)
                        the QoS rule is the default QoS rule
                        Number of packet filters: 1
                        packet filter 0
                          Packet filter identifier: 1
                          Packet filter direction: Bidirectional
                          Length of packet filter contents: 1
                          Packet filter content 0: Match-all type(1)
                        QoS rule precedence: 255
                        Segregation: Segregation not requested
                        QoS flow identifier: QFI6
                  Session AMBR
                    Length of Session-AMBR contents: 6
                    unit for Session-AMBR for downlink: (6)
                    Session-AMBR for downlink: 22
                    unit for Session-AMBR for uplink: (6)
                    Session-AMBR for uplink: 20
                  5GSM cause: 0x59
                    cause: (0)
                  PDU address: 0x29
                    Length: 5
                    PDU session type: IPv4(1)
                    PDU address information: 12.1.1.2
            PDU session ID: 0x12
              PDU session identity 2 value: 1
          S-NSSAI
            SST: 1
          PDU Session Resource Setup Request Transfer
          Protocol IEs: 4 items
            Item 0
[gnbsim]2021/03/07 10:48:47.200634 ngap.go:708: Unsupported Protocol IE: 130
              Protocol IE:  (130)
                IE length: 10
                  decoding id(130) not supported yet.
                  dump: 0c014fb1803001312d00
            Item 1
              Protocol IE: id-UL-NGU-UP-TNLInformation (139)
                IE length: 10
                  dump: 01f0c0a83ec93248c535
                  Transport Layer Address
                    bit string length: 32
                    address: 192.168.62.201
                  GTP TEID: 843629877
            Item 2
              Protocol IE: id-PDUSessionType (134)
                IE length: 1
                  PDU Session Type: ipv4 (0)
            Item 3
              Protocol IE: id-QosFlowSetupRequestList (136)
                IE length: 7
                  dump: 00060000060000
                  Item 0
                    Qos Flow Identifier: 6
                    Qos Flow Level Qos Prameters: not supported yet
[gnbsim]2021/03/07 10:48:47.200855 example.go:66: write: len 40, info: &{Stream:0 SSN:4 Flags:0 _:0 PPID:1006632960 Context:0 TTL:0 TSN:4191954159 CumTSN:0 AssocID:88}
[gnbsim]2021/03/07 10:48:48.200990 example.go:238: GTP-U interface name: eth0
[gnbsim]2021/03/07 10:48:48.201015 example.go:239: GTP-U local addr: 192.168.62.198
[gnbsim]2021/03/07 10:48:48.201030 example.go:240: GTP-U peer addr : 192.168.62.201
[gnbsim]2021/03/07 10:48:49.201805 example.go:325: GTP-U Peer TEID: 843629877
[gnbsim]2021/03/07 10:48:49.201827 example.go:326: GTP-U Local TEID: 2596996162
[gnbsim]2021/03/07 10:48:49.201836 example.go:327: QoS Flow ID: 6
[gnbsim]2021/03/07 10:48:49.201848 example.go:329: UE address: 12.1.1.2
doUPlane

